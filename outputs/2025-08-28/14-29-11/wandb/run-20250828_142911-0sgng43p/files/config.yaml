_wandb:
    value:
        cli_version: 0.21.1
        e:
            eyjjmjr8xt1zxfyvtyzrahcywet2w8ah:
                args:
                    - -cn
                    - bandit-musdb18hq
                codePath: scripts/train.py
                codePathLocal: scripts/train.py
                cpu_count: 24
                cpu_count_logical: 32
                disk:
                    /:
                        total: "3935709487104"
                        used: "2975908478976"
                email: kwatcharasupat@gatech.edu
                executable: /home/kwatchar3/anaconda3/envs/banda/bin/python
                git:
                    commit: 06cdd2e2b34ad176e1702a2c7d06c7a5b73bcb73
                    remote: https://github.com/kwatcharasupat/banda.git
                host: deepnet4.music.gatech.edu
                memory:
                    total: "134795247616"
                os: Linux-6.8.0-78-generic-x86_64-with-glibc2.39
                program: /home/kwatchar3/projects/banda/scripts/train.py
                python: CPython 3.12.11
                root: outputs/2025-08-28/14-29-11
                startedAt: "2025-08-28T14:29:11.824100Z"
                writerId: eyjjmjr8xt1zxfyvtyzrahcywet2w8ah
        m: []
        python_version: 3.12.11
        t:
            "1":
                - 1
                - 9
                - 50
                - 103
            "2":
                - 1
                - 9
                - 50
                - 103
            "3":
                - 16
            "4": 3.12.11
            "5": 0.21.1
            "12": 0.21.1
            "13": linux-x86_64
data:
    value:
        predict: null
        test: null
        train:
            dataloader:
                batch_size: 8
                drop_last: false
                num_workers: 4
                pin_memory: true
                shuffle: true
            dataset:
                dataset_connector:
                    config:
                        data_root: $DATA_ROOT/musdb18hq/intermediates/npz
                        split: train
                    target_: banda.data.datasets.musdb18hq.MUSDB18Connector
                fs: 44100
                postmix_transform:
                    _target_: banda.data.augmentations.base.ComposePostMixTransforms
                    transforms:
                        - _target_: banda.data.augmentations.time_domain.Gain
                          config:
                            max_gain_db: 6
                            min_gain_db: -6
                        - _target_: banda.data.augmentations.time_domain.NormalizeAudio
                          config:
                            target_rms_db: -20
                premix_transform:
                    _target_: banda.data.augmentations.base.ComposePreMixTransforms
                    transforms:
                        - _target_: banda.data.samplers.random_chunk.RandomChunkingTransform
                          config:
                            align_sources: true
                            chunk_size_seconds: 3
                            fs: 44100
                split: train
                target_: banda.data.datasets.musdb18hq.MUSDB18HQDataset
        val:
            dataloader:
                batch_size: 8
                drop_last: false
                num_workers: 4
                pin_memory: true
                shuffle: false
            dataset:
                dataset_connector:
                    config:
                        data_root: ${oc.env:$DATA_ROOT}/musdb18hq/intermediates/npz
                        split: val
                    target_: banda.data.datasets.musdb18hq.MUSDB18Connector
                fs: 44100
                postmix_transform: null
                premix_transform: null
                split: val
                target_: banda.data.datasets.musdb18hq.MUSDB18HQDataset
experiment_name:
    value: bandit_musdb18hq_test
log_level:
    value: INFO
logger:
    value:
        log_model: true
        project: banda
        save_dir: ${paths.output_dir}
        target_: lightning.pytorch.loggers.wandb.WandbLogger
loss:
    value:
        - name: multi_resolution_stft_loss
          params:
            _target_: banda.losses.multi_resolution_l1_snr.MultiResolutionSTFTLoss
            hop_lengths:
                - 512
                - 128
            log_scale: false
            mag_weight: 1
            n_ffts:
                - 2048
                - 512
            phase_weight: 0
            win_lengths:
                - 2048
                - 512
          target_: banda.losses.separation_loss_handler.SeparationLossHandler
          weight: 1
metrics:
    value:
        - name: snr
          params: {}
          target_: SignalNoiseRatio
model:
    value:
        _target_: banda.models.core_models.bandit_separator.Bandit
        bandsplit_module_config:
            _target_: banda.models.common_components.spectral_components.bandsplit.BandsplitModuleConfig
            emb_dim: 128
            input_channels: 2
        hidden_features: 256
        input_channels: 2
        mask_estimation_config:
            _target_: banda.models.common_components.mask_estimation.mask_estimation_modules.MaskEstimationConfig
            emb_dim: 128
            output_channels: 2
        num_sources: 4
        output_channels: 2
        stft_config:
            _target_: banda.models.common_components.spectral_components.spectral_base.STFTConfig
            center: true
            freeze_parameters: true
            hop_length: 512
            n_fft: 2048
            pad_mode: constant
            win_length: 2048
            window: hann
        time_frequency_model_config:
            _target_: banda.models.common_components.time_frequency_models.tf_models.RNNTFModelConfig
            bidirectional: true
            dropout: 0
            emb_dim: 128
            max_seq_len_bands: null
            max_seq_len_time: null
            n_modules: 8
            rnn_dim: 256
            rnn_type: GRU
optimizer:
    value:
        lr: 0.001
        target_: torch.optim.Adam
paths:
    value:
        data_root: ~/Documents/data
        log_dir: outputs/2025-08-28/14-29-11/logs
        output_dir: outputs/2025-08-28/14-29-11
project_root:
    value: ${oc.env:PROJECT_ROOT,.}
seed:
    value: 42
trainer:
    value:
        accelerator: auto
        devices: auto
        log_every_n_steps: 50
        max_epochs: 5
        precision: 32
        target_: pytorch_lightning.Trainer
