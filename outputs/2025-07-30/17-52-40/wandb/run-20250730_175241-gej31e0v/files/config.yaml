_wandb:
    value:
        cli_version: 0.21.0
        e:
            sjeftzy975dyafkpf47r4ozywgevgb40:
                apple:
                    ecpuCores: 6
                    gpuCores: 18
                    memoryGb: 18
                    name: Apple M3 Pro
                    pcpuCores: 6
                    ramTotalBytes: "19327352832"
                    swapTotalBytes: "34359738368"
                args:
                    - -cn
                    - train_bandit_musdb18hq_test
                codePath: src/banda/train.py
                codePathLocal: src/banda/train.py
                cpu_count: 12
                cpu_count_logical: 12
                disk:
                    /:
                        total: "994662584320"
                        used: "991768862720"
                email: kwatcharasupat@gatech.edu
                executable: /Users/kwatcharasupat/miniforge3/envs/banda/bin/python
                git:
                    commit: 491256602c6c95fe378231dfddd4e83f7c6f4f4e
                    remote: https://github.com/kwatcharasupat/banda.git
                host: kwatcharasupat-2.local
                memory:
                    total: "19327352832"
                os: macOS-15.5-arm64-arm-64bit
                program: /Users/kwatcharasupat/personal/banda/src/banda/train.py
                python: CPython 3.12.11
                root: outputs/2025-07-30/17-52-40
                startedAt: "2025-07-30T23:52:41.185660Z"
                writerId: sjeftzy975dyafkpf47r4ozywgevgb40
        m: []
        python_version: 3.12.11
        t:
            "1":
                - 1
                - 9
                - 50
                - 103
            "2":
                - 1
                - 9
                - 50
                - 103
            "3":
                - 2
                - 16
            "4": 3.12.11
            "5": 0.21.0
            "12": 0.21.0
            "13": darwin-arm64
data:
    value:
        batch_size: 4
        num_workers: 0
        pin_memory: false
        target_: banda.data.datamodule.SourceSeparationDataModule
        test_dataset_config:
            config:
                dataset_connector:
                    config:
                        data_root: /Users/kwatcharasupat/personal/data/musdb18hq/intermediates/npz
                        split: test
                    target_: banda.data.datasets.musdb18hq.MUSDB18Connector
                fs: 44100
                premix_transform:
                    chunk_size_seconds: 3
                    fs: 44100
                    target_: banda.data.samplers.random_chunk.RandomChunkingTransform
                split: test
            target_: banda.data.datasets.musdb18hq.MUSDB18HQDataset
        train_dataset_config:
            config:
                dataset_connector:
                    config:
                        data_root: /Users/kwatcharasupat/personal/data/musdb18hq/intermediates/npz
                        split: train
                    target_: banda.data.datasets.musdb18hq.MUSDB18Connector
                fs: 44100
                premix_transform:
                    chunk_size_seconds: 3
                    fs: 44100
                    target_: banda.data.samplers.random_chunk.RandomChunkingTransform
                split: train
            target_: banda.data.datasets.musdb18hq.MUSDB18HQDataset
        val_dataset_config:
            config:
                dataset_connector:
                    config:
                        data_root: /Users/kwatcharasupat/personal/data/musdb18hq/intermediates/npz
                        split: val
                    target_: banda.data.datasets.musdb18hq.MUSDB18Connector
                fs: 44100
                premix_transform:
                    chunk_size_seconds: 3
                    fs: 44100
                    target_: banda.data.samplers.random_chunk.RandomChunkingTransform
                split: val
            target_: banda.data.datasets.musdb18hq.MUSDB18HQDataset
experiment_name:
    value: bandit_musdb18hq_test
log_level:
    value: INFO
loss:
    value:
        _target_: banda.losses.separation_loss_handler.SeparationLossHandler
        stft_loss_fn:
            _target_: banda.losses.multi_resolution_l1_snr.MultiResolutionSTFTLoss
            hop_lengths:
                - 512
                - 128
            n_ffts:
                - 2048
                - 512
            win_lengths:
                - 2048
                - 512
        time_loss_fn:
            _target_: banda.losses.time_domain_loss.TimeDomainLoss
metrics:
    value:
        _target_: torchmetrics.audio.ScaleInvariantSignalNoiseRatio
model:
    value:
        _target_: banda.models.core_models.banquet_separator.Banquet
        bandsplit:
            band_specs:
                bandsplit_type: musical
                n_bands: 64
            normalize_channel_independently: false
            require_no_gap: true
            require_no_overlap: false
            treat_channel_as_feature: true
        emb_dim: 128
        fs: 44100
        in_channel: 2
        mask_estim:
            _target_: banda.models.common_components.configs.common_configs.MaskEstimationConfig
            complex_mask: true
            hidden_activation: Tanh
            hidden_activation_kwargs: null
            in_channel: 2
            mlp_dim: 512
            use_freq_weights: false
        query_features: 128
        stems:
            - vocals
            - bass
            - drums
            - other
        stft:
            _target_: banda.models.common_components.configs.common_configs.STFTConfig
            center: true
            hop_length: 512
            n_fft: 2048
            normalized: true
            onesided: true
            pad_mode: constant
            power: null
            win_length: 2048
            window_fn: hann_window
            wkwargs: null
        tfmodel:
            _target_: banda.models.common_components.time_frequency_models.tf_models.TransformerTimeFreqModule
            dim_feedforward: 1024
            dropout: 0
            emb_dim: 128
            max_seq_len_bands: 256
            max_seq_len_time: 512
            n_modules: 4
            nhead: 8
optimizer:
    value: '{''_target_'': ''torch.optim.Adam'', ''lr'': 0.001}'
paths:
    value:
        data_dir: ./data
        log_dir: outputs/2025-07-30/17-52-40/logs
        output_dir: outputs/2025-07-30/17-52-40
seed:
    value: 42
trainer:
    value:
        accelerator: auto
        devices: auto
        gradient_clip_algorithm: norm
        gradient_clip_val: 5
        limit_train_batches: 5
        limit_val_batches: 5
        log_every_n_steps: 1
        max_epochs: 1
        target_: pytorch_lightning.Trainer
