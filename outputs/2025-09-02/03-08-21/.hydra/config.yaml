model:
  cls: FixedStemBandit
  params:
    spectrogram:
      n_fft: 2048
      hop_length: 512
      win_length: 2048
      window: hann
      fs: 44100
    normalization:
      eps: 1.0e-06
      dbrms_threshold: -60
    bandsplit:
      n_bands: 64
      in_channels: 2
      emb_dim: 128
    tf_model:
      n_modules: 8
      rnn_type: GRU
      emb_dim: ${..bandsplit.emb_dim}
      rnn_dim: 256
      bidirectional: true
    mask_estim:
      emb_dim: ${..bandsplit.emb_dim}
      mlp_dim: 256
      in_channels: ${..bandsplit.in_channels}
    stems:
    - vocals
data:
  train:
    datasource:
    - cls: MUSDB18HQDatasource
      params:
        split: train
    dataset:
      cls: RandomChunkDataset
      params:
        n_channels: 2
        fs: 44100
        chunk_size_seconds: 6.0
        allow_autolooping: true
        max_dataset_size: 128
        premix_augmentation:
          augmentations:
          - cls: Gain
            params:
              min_gain_db: -6
              max_gain_db: 6.0
              p: 0.5
          - cls: Shift
            params:
              min_shift: -0.5
              max_shift: 0.5
              shift_unit: fraction
              rollover: true
              p: 0.5
          - cls: PolarityInversion
            params:
              p: 0.5
          - cls: RandomDrop
            params:
              p: 0.1
    dataloader:
      batch_size: 8
      num_workers: 16
      shuffle: true
      drop_last: false
      pin_memory: true
      prefetch_factor: 4
  val:
    datasource:
    - cls: MUSDB18HQDatasource
      params:
        split: val
        load_duration: true
    dataset:
      cls: DeterministicChunkDataset
      params:
        n_channels: 2
        fs: 44100
        chunk_size_seconds: 6.0
        hop_size_seconds: 6.0
        allow_autolooping: false
        max_dataset_size: 1024
    dataloader:
      batch_size: 8
      num_workers: 16
      shuffle: false
      drop_last: false
      pin_memory: true
  test:
    datasource:
    - cls: MUSDB18HQDatasource
      params:
        split: test
    dataset:
      cls: FullTrackDataset
      params:
        n_channels: 2
        fs: 44100
        allow_autolooping: false
    dataloader:
      batch_size: 32
      num_workers: 4
      shuffle: true
      drop_last: false
      pin_memory: true
logger: {}
loss:
  losses:
  - cls: L1SNRLoss
    weight: 1.0
    params:
      domain: time
      eps: 0.001
  - cls: L1SNRLoss
    weight: 1.0
    params:
      domain: spectrogram
      eps: 0.001
  - cls: DecibelMatchLoss
    weight: 1.0
    params:
      eps: 1.0e-06
      adaptive: true
      min_weight: 0.1
      max_weight: 1.0
      min_db: -60
      max_below_true: 12
metrics:
  metrics:
  - cls: SignalNoiseRatio
    params: {}
  stems:
  - vocals
optimizer:
  optimizer:
    cls: AdamW
    params:
      lr: 0.001
      fused: true
  scheduler:
    cls: StepLR
    kwargs:
      step_size: 2
      gamma: 0.98
seed: 42
